# Сервис "Библиотека"
## Получение списка читателей
- Метод: GET
- Путь: /readers
- Тело запроса (JSON): пустое
- URL параметры: 
    - `query`* - поиск по любой части номера читательского билета или id человека
    
    ИЛИ**
    - `readTicket` - поиск по номеру читательского билета
    - `id` - поиск по id человека
    
\* `query` - приоритетный параметр, если он указан, то `readTicket`, `id` будут проигнорированы

\** - поиск по полям `readTicket`/`id` можно комбинировать; 

- Формат ответа: JSON массив с читателями ИЛИ [ошибка](#Ошибки)

Если не указан ни один URL параметр, то будут возвращены все читатели из базы данных.

## Получение читателя по readTicket
- Метод: GET
- Путь: /readers/{readTicket}
- Тело запроса (JSON): пустое
- URL параметры: отсутствуют
- Формат ответа: JSON объект (читатель) ИЛИ [ошибка](#Ошибки)

## Добавление читателя
- Метод: POST
- Путь: /readers
- Тело запроса (JSON): 
    - `email`* - эл. почта
    - `FIO`* - Фамилия Имя Отчество
- URL параметры: отсутствуют
- Формат ответа: JSON объект формата `CreateResult` ИЛИ [ошибка](#Ошибки)

Модель ответа `CreateResult`:
```js
{
    data: Readers, // сама модель объекта Readers
    wasFound: boolean // если true - читатель существует и возвращён из БД; false - создан и сохранён в БД
}
```
Пример: 
```json
{
  "data": {
    "FIO": "Osokin Mixail Alexevich",
    "email": "osm@mail.com"
  },
  "wasFound": false
}
```

\* - обязательные поля

## Редактирование читателя
- Метод: PUT
- Путь: /readers/{readTicket}
- Тело запроса (JSON): 
    - `id` - редактирование id человека
- URL параметры: отсутствуют
- Формат ответа: JSON объект (читатель) ИЛИ [ошибка](#Ошибки)

\* - обязательные поля

## Удаление читателя
- Метод: DELETE
- Путь: /readers/{readTicket}
- Тело запроса (JSON): пустое
- URL параметры: отсутствуют
- Формат ответа: JSON объект с полями:
    - `affectedRows` - кол-во затронутых (удалённых) записей в базе данных
    - `ok` - успешно ли удаление (*true* или *false*)
   
  ИЛИ [ошибка](#Ошибки)

## Ошибки
Представляют из себя объект с полями:
- `statusCode` - HTTP код ошибки
- `error` - соответствующий HTTP коду текст ошибки
- `message` - текст ошибки, отправленный сервисом

Например:
```json
{
  "statusCode": 404,
  "error": "Not Found",
  "message": "Could not find any entity of type \"Readers\" readTicket: \"2222\""
}
```
## Получение списка выдачи
- Метод: GET
- Путь: /giveout
- Тело запроса (JSON): пустое
- URL параметры: 
    - `query`* - поиск по любой части даты выдачи,даты возврата,id книги и id выдачи.
    
    ИЛИ**
    - `readTicket` - поиск по номеру читательского билета
    - `dateReturn` - дата возврата книги
    - `dateGiveOut` - дата выдачи книги
    - `idBook` - id книги
    - `idGiveOut` - id выдачи
    
\* `query` - приоритетный параметр, если он указан, то `readTicket`, `idGiveOut` будут проигнорированы

\** - поиск по полям `readTicket`/`idGiveOut` можно комбинировать; 

- Формат ответа: JSON массив с выдачами ИЛИ [ошибка](#Ошибки)

Если не указан ни один URL параметр, то будут возвращены все выдачи из базы данных.

## Получение выдачи по idGiveOut
- Метод: GET
- Путь: /giveout/{idGiveOut}
- Тело запроса (JSON): пустое
- URL параметры: отсутствуют
- Формат ответа: JSON объект (выдача) ИЛИ [ошибка](#Ошибки)

## Добавление выдачи
- Метод: POST
- Путь: /giveout
- Тело запроса (JSON): 
    - `idBook`* - id книги
    - `readTicket`* - id читательского билета
    - `dateReturn`* - дата возврата книги
- URL параметры: отсутствуют
- Формат ответа: JSON объект формата `CreateResult` ИЛИ [ошибка](#Ошибки)

Модель ответа `CreateResult`:
```js
{
    data: Giveout, // сама модель объекта Giveout
    wasFound: boolean // если true - выдача существует и возвращёна из БД; false - создана и сохранёна в БД
}
```
Пример: 
```json
{
  "data": {
    "idGiveOut": "2222",
    "readTicket": "0072",
    "dateGiveOut": "18022019",
    "dateReturn": "25072019",
    "idBook": "55"
  },
  "wasFound": false
}
```

\* - обязательные поля

## Редактирование выдачи
- Метод: PUT
- Путь: /giveout/{idGiveOut}
- Тело запроса (JSON): 
    - `idBook` - id книги
    - `readTicket` - id читательского билета
    - `dateReturn` - дата возврата книги
- URL параметры: отсутствуют
- Формат ответа: JSON объект (выдача) ИЛИ [ошибка](#Ошибки)

\* - обязательные поля

## Удаление выдачи
- Метод: DELETE
- Путь: /giveout/{idGiveOut}
- Тело запроса (JSON): пустое
- URL параметры: отсутствуют
- Формат ответа: JSON объект с полями:
    - `affectedRows` - кол-во затронутых (удалённых) записей в базе данных
    - `ok` - успешно ли удаление (*true* или *false*)
   
  ИЛИ [ошибка](#Ошибки)

## Ошибки
Представляют из себя объект с полями:
- `statusCode` - HTTP код ошибки
- `error` - соответствующий HTTP коду текст ошибки
- `message` - текст ошибки, отправленный сервисом

Например:
```json
{
  "statusCode": 404,
  "error": "Not Found",
  "message": "Could not find any entity of type \"Giveout\" idGiveOut: \"2222\""
}
```
## Получение списка книг
- Метод: GET
- Путь: /books
- Тело запроса (JSON): пустое
- URL параметры: 
    - `query`* - поиск по любой части автора,имени книги, id книги.
    
    ИЛИ**
    - `idBook` - id книги
    - `name` - название книги
    - `author` - автор книги
    - `year` - год издания книги
    - `amount` - количество данных книг
    
\* `query` - приоритетный параметр, если он указан, то `idBook`, `name` будут проигнорированы

\** - поиск по полям `idBook`/`name` можно комбинировать; 

- Формат ответа: JSON массив с читателями ИЛИ [ошибка](#Ошибки)

Если не указан ни один URL параметр, то будут возвращены все книги из базы данных.

## Получение книги по idBook
- Метод: GET
- Путь: /books/{idBook}
- Тело запроса (JSON): пустое
- URL параметры: отсутствуют
- Формат ответа: JSON объект (книга) ИЛИ [ошибка](#Ошибки)

## Добавление книги
- Метод: POST
- Путь: /books
- Тело запроса (JSON): 
    - `name`* - название книги
    - `author`* - автор книги
    - `year`* - год издания книги
    - `amount`* - количество книг
- URL параметры: отсутствуют
- Формат ответа: JSON объект формата `CreateResult` ИЛИ [ошибка](#Ошибки)

Модель ответа `CreateResult`:
```js
{
    data: Books, // сама модель объекта Books
    wasFound: boolean // если true - книга существует и возвращёна из БД; false - создана и сохранёна в БД
}
```
Пример: 
```json
{
  "data": {
    "idBook": "025",
    "name": "Go to Mars",
    "author": "Inkognito",
    "year": "01022001",
    "amount": "3"
  },
  "wasFound": false
}
```

\* - обязательные поля

## Редактирование книги
- Метод: PUT
- Путь: /books/{idBook}
- Тело запроса (JSON): 
    - `name`* - название книги
    - `author`* - автор книги
    - `year`* - год издания книги
    - `amount`* - количество книг
- URL параметры: отсутствуют
- Формат ответа: JSON объект (книга) ИЛИ [ошибка](#Ошибки)

\* - обязательные поля

## Удаление книги
- Метод: DELETE
- Путь: /books/{idBook}
- Тело запроса (JSON): пустое
- URL параметры: отсутствуют
- Формат ответа: JSON объект с полями:
    - `affectedRows` - кол-во затронутых (удалённых) записей в базе данных
    - `ok` - успешно ли удаление (*true* или *false*)
   
  ИЛИ [ошибка](#Ошибки)

## Ошибки
Представляют из себя объект с полями:
- `statusCode` - HTTP код ошибки
- `error` - соответствующий HTTP коду текст ошибки
- `message` - текст ошибки, отправленный сервисом

Например:
```json
{
  "statusCode": 404,
  "error": "Not Found",
  "message": "Could not find any entity of type \"Books\" idBook: \"2222\""
}
```

